.row.m-t-10
  .col-md-12
    = render 'settings_common_header'
    .row.panelized
      .col-xs-12
        %h3 General Settings
      .col-xs.12
        -# TODO: Show this only to project owner
        %a{:href => "https://slack.com/oauth/authorize?scope=incoming-webhook&client_id=8759406016.67241376853&redirect_uri=" + "http://localhost:3000/webhooks/slack/#{current_project.id}"}
          %img{:alt => "Add to Slack", :height => "40",
            :src => "https://platform.slack-edge.com/img/add_to_slack.png",
            :srcset => "https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x",
            :width => "139"}
      .col-md-6.m-b-10
        = simple_form_for current_project do |f|
          - repo_provider = current_project.repository_provider
          - if repo_provider == 'bare_repo'
            - #TODO: In the future we might be able to avoid restarting by sending
            - # the new repository_url to the active workers
            = f.input :repository_url, hint: "You will need to restart your workers after changing this setting"
          - else
            %h4 Auto-tracking branches
            = f.input :auto_track_branches, as: :boolean,
              label: "Automatically track a branch when it is pushed to #{repo_provider == "github" ? "GitHub" : "Bitbucket" }"
          = f.submit "Save", class: "btn btn-primary"

      - if can? :manage, current_project
        .col-md-6
          - if current_project.is_private?
            .well.col-xs-12
              .col-md-10
                %strong Make your project public: <br>
                Anyone will be able to access your public pages.
                Users who do not participate will not have access to project configuration,
                credentials or be able to add/remove builds.
              .col-md-2
                = button_to "Public", toggle_private_project_path(current_project), method: :post,
                  data: { confirm: "'#{current_project.name}' project will become public. Are you sure?" },
                  class: 'btn btn-md btn-success'
          - else
            .well.col-xs-12
              .col-md-10
                %strong Make your project private: <br>
                User which are not members of this project will <strong> NOT </strong> be able
                to access your pages.
              .col-md-2
                = button_to "Private", toggle_private_project_path(current_project), method: :post,
                  data: { confirm: "'#{current_project.name}' project will become private. Are you sure?" },
                  class: 'btn btn-md btn-danger'

          .well.col-xs-12
            .col-md-10
              %strong Delete project from Testributor: <br>
              This action cannot be reverted. All your builds will be discarded.
            .col-md-2
              = button_to "Delete", project_path(current_project), method: :delete,
                data: { confirm: "'#{current_project.name}' project will be deleted. Are you sure?" },
                class: 'btn btn-md btn-danger'
